<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>欢迎使用 - 大学生职业生涯规划指导</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36D399',
                        accent: '#FF9F1C',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .step-indicator-active {
                background-color: #165DFF;
                color: white;
            }
            .step-indicator-completed {
                background-color: #36D399;
                color: white;
            }
            .step-line-active {
                background-color: #165DFF;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
    <!-- 头部 -->
    <header class="bg-white shadow-sm py-4 px-6">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-graduation-cap text-primary text-2xl"></i>
                <h1 class="text-xl font-bold text-dark">生涯规划助手</h1>
            </div>
            <div class="text-sm text-gray-500">大学生职业发展指导平台</div>
        </div>
    </header>

    <!-- 进度指示器 -->
    <div class="container mx-auto px-6 py-8">
        <div class="flex items-center justify-between mb-8 max-w-2xl mx-auto">
            <div class="flex flex-col items-center">
                <div id="step1-indicator" class="w-8 h-8 rounded-full flex items-center justify-center border-2 border-primary font-bold step-indicator-active">1</div>
                <div class="text-xs mt-2 text-center">欢迎</div>
            </div>
            <div class="flex-1 h-1 mx-2 step-line-active" id="line1-2"></div>
            <div class="flex flex-col items-center">
                <div id="step2-indicator" class="w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-300 font-bold text-gray-500">2</div>
                <div class="text-xs mt-2 text-center text-gray-500">隐私协议</div>
            </div>
            <div class="flex-1 h-1 mx-2 bg-gray-300" id="line2-3"></div>
            <div class="flex flex-col items-center">
                <div id="step3-indicator" class="w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-300 font-bold text-gray-500">3</div>
                <div class="text-xs mt-2 text-center text-gray-500">完善信息</div>
            </div>
        </div>

        <!-- 步骤容器 -->
        <div class="max-w-2xl mx-auto bg-white rounded-xl shadow-md p-6">
            <!-- 步骤1：欢迎 -->
            <div id="step1" class="step-content">
                <div class="text-center mb-8">
                    <div class="w-20 h-20 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-handshake-o text-primary text-3xl"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-dark mb-2">欢迎使用生涯规划助手</h2>
                    <p class="text-gray-600">我们将为您提供个性化的大学生职业生涯规划指导</p>
                </div>
                
                <div class="space-y-4">
                    <div class="flex items-center p-4 bg-blue-50 rounded-lg">
                        <div class="bg-primary/20 p-2 rounded-full mr-4">
                            <i class="fa fa-lightbulb-o text-primary"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-dark">个性化职业规划</h3>
                            <p class="text-sm text-gray-600">根据您的专业背景和兴趣提供定制化职业建议</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-4 bg-green-50 rounded-lg">
                        <div class="bg-secondary/20 p-2 rounded-full mr-4">
                            <i class="fa fa-book text-secondary"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-dark">职业资料库</h3>
                            <p class="text-sm text-gray-600">丰富的行业、职业和发展路径信息</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-4 bg-orange-50 rounded-lg">
                        <div class="bg-accent/20 p-2 rounded-full mr-4">
                            <i class="fa fa-graduation-cap text-accent"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-dark">就业指导</h3>
                            <p class="text-sm text-gray-600">帮助您提升就业竞争力，规划职业发展</p>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <button id="to-step2" class="w-full py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors">
                        开始规划
                    </button>
                </div>
            </div>

            <!-- 步骤2：隐私协议 -->
            <div id="step2" class="step-content hidden">
                <h2 class="text-xl font-bold text-dark mb-4">隐私协议与服务条款</h2>
                
                <div class="h-80 overflow-y-auto scrollbar-hide p-4 border border-gray-200 rounded-lg mb-6 bg-gray-50">
                    <div class="text-sm text-gray-700 space-y-4">
                        <h3 class="font-semibold text-dark">隐私政策</h3>
                        <p>欢迎使用大学生职业生涯规划指导服务（以下简称"本服务"）。在您使用本服务前，请仔细阅读并了解本隐私政策的全部内容。</p>
                        
                        <h4 class="font-semibold">1. 信息收集与使用</h4>
                        <p>我们收集的信息可能包括但不限于您的姓名、联系方式、教育背景、学习成绩等个人信息。这些信息将用于为您提供个性化的咨询服务、生成相关报告和分析结果。</p>
                        
                        <h4 class="font-semibold">2. 信息保护</h4>
                        <p>我们重视您的个人信息安全，采取严格的安全措施保护您的信息不被未经授权的访问、使用或披露。</p>
                        
                        <h4 class="font-semibold">3. 信息共享</h4>
                        <p>未经您的明确同意，我们不会向任何第三方共享您的个人信息，但法律法规要求的除外。</p>
                        
                        <h3 class="font-semibold text-dark mt-6">服务条款</h3>
                        <p>使用本服务，即表示您同意遵守以下服务条款：</p>
                        
                        <h4 class="font-semibold">1. 服务内容</h4>
                        <p>本服务提供大学生职业生涯规划相关的咨询、指导和信息查询服务。我们不保证所有信息的绝对准确性，建议您在做出决策前进行多方核实。</p>
                        
                        <h4 class="font-semibold">2. 用户行为</h4>
                        <p>您在使用本服务时应遵守法律法规，不得利用本服务进行任何违法或不当行为。</p>
                        
                        <h4 class="font-semibold">3. 知识产权</h4>
                        <p>本服务包含的所有内容，包括但不限于文字、图片、数据等，均受知识产权保护。未经授权，不得复制、传播或用于其他用途。</p>
                        
                        <h4 class="font-semibold">4. 服务变更</h4>
                        <p>我们有权根据需要变更服务内容或终止部分服务，如有重大变更将及时通知您。</p>
                    </div>
                </div>
                
                <div class="flex items-center mb-6">
                    <input type="checkbox" id="accept-privacy" class="w-4 h-4 text-primary rounded mr-2">
                    <label for="accept-privacy" class="text-sm text-gray-700">我已阅读并同意隐私政策和服务条款</label>
                </div>
                
                <div class="flex space-x-4">
                    <button id="back-to-step1" class="flex-1 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors">
                        返回
                    </button>
                    <button id="to-step3" class="flex-1 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors" disabled>
                        下一步
                    </button>
                </div>
            </div>

            <!-- 步骤3：信息收集 -->
            <div id="step3" class="step-content hidden">
                <h2 class="text-xl font-bold text-dark mb-4">完善个人信息</h2>
                <p class="text-sm text-gray-500 mb-6">请填写以下信息，帮助我们为您提供更精准的职业生涯规划服务</p>
                
                <form id="student-info-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">姓名 <span class="text-red-500">*</span></label>
                        <input type="text" id="student-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">教育阶段 <span class="text-red-500">*</span></label>
                        <select id="education-level" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50" required>
                            <option value="">请选择</option>
                            <option value="初中">初中</option>
                            <option value="高中">高中</option>
                            <option value="中职">中职</option>
                            <option value="高职">高职</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">感兴趣的专业领域</label>
                        <input type="text" id="interest-major" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="例如：计算机、机械、护理等">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">升学目标</label>
                        <select id="升学目标" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                            <option value="">请选择</option>
                            <option value="升入高职">升入高职</option>
                            <option value="升入本科">升入本科</option>
                            <option value="升入专科">升入专科</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                    
                    <!-- 基础身份信息 -->
                    <div class="pt-4">
                        <h4 class="text-base font-semibold mb-3 text-dark">基础身份信息</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1 text-gray-700">性别</label>
                                <select id="gender" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                                    <option value="">请选择</option>
                                    <option value="男">男</option>
                                    <option value="女">女</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-1 text-gray-700">出生日期</label>
                                <input type="date" id="birth-date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 户籍所在地 -->
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">户籍所在地</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <select id="household-province" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
                                    <option value="">请选择省份</option>
                                    <option value="北京市">北京市</option>
                                    <option value="上海市">上海市</option>
                                    <option value="天津市">天津市</option>
                                    <option value="重庆市">重庆市</option>
                                    <option value="河北省">河北省</option>
                                    <option value="山西省">山西省</option>
                                    <option value="内蒙古自治区">内蒙古自治区</option>
                                    <option value="辽宁省">辽宁省</option>
                                    <option value="吉林省">吉林省</option>
                                    <option value="黑龙江省">黑龙江省</option>
                                    <option value="江苏省">江苏省</option>
                                    <option value="浙江省">浙江省</option>
                                    <option value="安徽省">安徽省</option>
                                    <option value="福建省">福建省</option>
                                    <option value="江西省">江西省</option>
                                    <option value="山东省">山东省</option>
                                    <option value="河南省">河南省</option>
                                    <option value="湖北省">湖北省</option>
                                    <option value="湖南省">湖南省</option>
                                    <option value="广东省">广东省</option>
                                    <option value="广西壮族自治区">广西壮族自治区</option>
                                    <option value="海南省">海南省</option>
                                    <option value="四川省">四川省</option>
                                    <option value="贵州省">贵州省</option>
                                    <option value="云南省">云南省</option>
                                    <option value="西藏自治区">西藏自治区</option>
                                    <option value="陕西省">陕西省</option>
                                    <option value="甘肃省">甘肃省</option>
                                    <option value="青海省">青海省</option>
                                    <option value="宁夏回族自治区">宁夏回族自治区</option>
                                    <option value="新疆维吾尔自治区">新疆维吾尔自治区</option>
                                </select>
                            </div>
                            <div>
                                <select id="household-city" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50" disabled>
                                    <option value="">请先选择省份</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium mb-1 text-gray-700">联系方式</label>
                        <input type="text" id="contact-info" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="手机号码或邮箱">
                    </div>
                    
                    <div class="flex space-x-4 mt-8">
                        <button type="button" id="back-to-step2" class="flex-1 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors">
                            返回
                        </button>
                        <button type="submit" class="flex-1 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors">
                            完成并进入系统
                        </button>
                    </div>
                    
                    <div class="flex items-center mt-4">
                        <input type="checkbox" id="skip-onboarding" class="w-4 h-4 text-primary rounded mr-2">
                        <label for="skip-onboarding" class="text-sm text-gray-600">不再显示此协议（下次访问将直接进入主页）</label>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // 省市数据
        const cityData = {
            "北京市": ["北京市"],
            "上海市": ["上海市"],
            "天津市": ["天津市"],
            "重庆市": ["重庆市"],
            "河北省": ["石家庄市", "唐山市", "秦皇岛市", "邯郸市", "邢台市", "保定市", "张家口市", "承德市", "沧州市", "廊坊市", "衡水市"],
            "山西省": ["太原市", "大同市", "阳泉市", "长治市", "晋城市", "朔州市", "晋中市", "运城市", "忻州市", "临汾市", "吕梁市"],
            "内蒙古自治区": ["呼和浩特市", "包头市", "乌海市", "赤峰市", "通辽市", "鄂尔多斯市", "呼伦贝尔市", "巴彦淖尔市", "乌兰察布市", "兴安盟", "锡林郭勒盟", "阿拉善盟"],
            "辽宁省": ["沈阳市", "大连市", "鞍山市", "抚顺市", "本溪市", "丹东市", "锦州市", "营口市", "阜新市", "辽阳市", "盘锦市", "铁岭市", "朝阳市", "葫芦岛市"],
            "吉林省": ["长春市", "吉林市", "四平市", "辽源市", "通化市", "白山市", "松原市", "白城市", "延边朝鲜族自治州"],
            "黑龙江省": ["哈尔滨市", "齐齐哈尔市", "鸡西市", "鹤岗市", "双鸭山市", "大庆市", "伊春市", "佳木斯市", "七台河市", "牡丹江市", "黑河市", "绥化市", "大兴安岭地区"],
            "江苏省": ["南京市", "无锡市", "徐州市", "常州市", "苏州市", "南通市", "连云港市", "淮安市", "盐城市", "扬州市", "镇江市", "泰州市", "宿迁市"],
            "浙江省": ["杭州市", "宁波市", "温州市", "嘉兴市", "湖州市", "绍兴市", "金华市", "衢州市", "舟山市", "台州市", "丽水市"],
            "安徽省": ["合肥市", "芜湖市", "蚌埠市", "淮南市", "马鞍山市", "淮北市", "铜陵市", "安庆市", "黄山市", "滁州市", "阜阳市", "宿州市", "六安市", "亳州市", "池州市", "宣城市"],
            "福建省": ["福州市", "厦门市", "莆田市", "三明市", "泉州市", "漳州市", "南平市", "龙岩市", "宁德市"],
            "江西省": ["南昌市", "景德镇市", "萍乡市", "九江市", "新余市", "鹰潭市", "赣州市", "吉安市", "宜春市", "抚州市", "上饶市"],
            "山东省": ["济南市", "青岛市", "淄博市", "枣庄市", "东营市", "烟台市", "潍坊市", "济宁市", "泰安市", "威海市", "日照市", "临沂市", "德州市", "聊城市", "滨州市", "菏泽市"],
            "河南省": ["郑州市", "开封市", "洛阳市", "平顶山市", "安阳市", "鹤壁市", "新乡市", "焦作市", "濮阳市", "许昌市", "漯河市", "三门峡市", "南阳市", "商丘市", "信阳市", "周口市", "驻马店市"],
            "湖北省": ["武汉市", "黄石市", "十堰市", "宜昌市", "襄阳市", "鄂州市", "荆门市", "孝感市", "荆州市", "黄冈市", "咸宁市", "随州市", "恩施土家族苗族自治州"],
            "湖南省": ["长沙市", "株洲市", "湘潭市", "衡阳市", "邵阳市", "岳阳市", "常德市", "张家界市", "益阳市", "郴州市", "永州市", "怀化市", "娄底市", "湘西土家族苗族自治州"],
            "广东省": ["广州市", "韶关市", "深圳市", "珠海市", "汕头市", "佛山市", "江门市", "湛江市", "茂名市", "肇庆市", "惠州市", "梅州市", "汕尾市", "河源市", "阳江市", "清远市", "东莞市", "中山市", "潮州市", "揭阳市", "云浮市"],
            "广西壮族自治区": ["南宁市", "柳州市", "桂林市", "梧州市", "北海市", "防城港市", "钦州市", "贵港市", "玉林市", "百色市", "贺州市", "河池市", "来宾市", "崇左市"],
            "海南省": ["海口市", "三亚市", "三沙市", "儋州市"],
            "四川省": ["成都市", "自贡市", "攀枝花市", "泸州市", "德阳市", "绵阳市", "广元市", "遂宁市", "内江市", "乐山市", "南充市", "眉山市", "宜宾市", "广安市", "达州市", "雅安市", "巴中市", "资阳市", "阿坝藏族羌族自治州", "甘孜藏族自治州", "凉山彝族自治州"],
            "贵州省": ["贵阳市", "六盘水市", "遵义市", "安顺市", "毕节市", "铜仁市", "黔西南布依族苗族自治州", "黔东南苗族侗族自治州", "黔南布依族苗族自治州"],
            "云南省": ["昆明市", "曲靖市", "玉溪市", "保山市", "昭通市", "丽江市", "普洱市", "临沧市", "楚雄彝族自治州", "红河哈尼族彝族自治州", "文山壮族苗族自治州", "西双版纳傣族自治州", "大理白族自治州", "德宏傣族景颇族自治州", "怒江傈僳族自治州", "迪庆藏族自治州"],
            "西藏自治区": ["拉萨市", "日喀则市", "昌都市", "林芝市", "山南市", "那曲市", "阿里地区"],
            "陕西省": ["西安市", "铜川市", "宝鸡市", "咸阳市", "渭南市", "延安市", "汉中市", "榆林市", "安康市", "商洛市"],
            "甘肃省": ["兰州市", "嘉峪关市", "金昌市", "白银市", "天水市", "武威市", "张掖市", "平凉市", "酒泉市", "庆阳市", "定西市", "陇南市", "临夏回族自治州", "甘南藏族自治州"],
            "青海省": ["西宁市", "海东市", "海北藏族自治州", "黄南藏族自治州", "海南藏族自治州", "果洛藏族自治州", "玉树藏族自治州", "海西蒙古族藏族自治州"],
            "宁夏回族自治区": ["银川市", "石嘴山市", "吴忠市", "固原市", "中卫市"],
            "新疆维吾尔自治区": ["乌鲁木齐市", "克拉玛依市", "吐鲁番市", "哈密市", "昌吉回族自治州", "博尔塔拉蒙古自治州", "巴音郭楞蒙古自治州", "阿克苏地区", "克孜勒苏柯尔克孜自治州", "喀什地区", "和田地区", "伊犁哈萨克自治州", "塔城地区", "阿勒泰地区"]
        };

        // 省份选择事件
        document.getElementById('household-province').addEventListener('change', function() {
            const province = this.value;
            const citySelect = document.getElementById('household-city');
            
            if (province === '') {
                citySelect.innerHTML = '<option value="">请先选择省份</option>';
                citySelect.disabled = true;
            } else {
                const cities = cityData[province] || [];
                let options = '<option value="">请选择城市</option>';
                cities.forEach(city => {
                    options += `<option value="${city}">${city}</option>`;
                });
                citySelect.innerHTML = options;
                citySelect.disabled = false;
            }
        });

        // 从localStorage恢复表单数据
        function restoreFormData() {
            const studentName = localStorage.getItem('studentName');
            const educationLevel = localStorage.getItem('educationLevel');
            const interestMajor = localStorage.getItem('interestMajor');
            const 升学目标 = localStorage.getItem('升学目标');
            const gender = localStorage.getItem('gender');
            const birthDate = localStorage.getItem('birthDate');
            const province = localStorage.getItem('householdProvince');
            const city = localStorage.getItem('householdCity');
            const contactInfo = localStorage.getItem('contactInfo');
            
            if (studentName) document.getElementById('student-name').value = studentName;
            if (educationLevel) document.getElementById('education-level').value = educationLevel;
            if (interestMajor) document.getElementById('interest-major').value = interestMajor;
            if (升学目标) document.getElementById('升学目标').value = 升学目标;
            if (gender) document.getElementById('gender').value = gender;
            if (birthDate) document.getElementById('birth-date').value = birthDate;
            if (province) {
                document.getElementById('household-province').value = province;
                // 触发省份选择事件以加载城市选项
                document.getElementById('household-province').dispatchEvent(new Event('change'));
                setTimeout(() => {
                    if (city) document.getElementById('household-city').value = city;
                }, 100);
            }
            if (contactInfo) document.getElementById('contact-info').value = contactInfo;
        }

        // 保存表单数据到localStorage
        function saveFormData() {
            localStorage.setItem('studentName', document.getElementById('student-name').value);
            localStorage.setItem('educationLevel', document.getElementById('education-level').value);
            localStorage.setItem('interestMajor', document.getElementById('interest-major').value);
            localStorage.setItem('升学目标', document.getElementById('升学目标').value);
            localStorage.setItem('gender', document.getElementById('gender').value);
            localStorage.setItem('birthDate', document.getElementById('birth-date').value);
            localStorage.setItem('householdProvince', document.getElementById('household-province').value);
            localStorage.setItem('householdCity', document.getElementById('household-city').value);
            localStorage.setItem('contactInfo', document.getElementById('contact-info').value);
        }

        // 步骤切换函数
        function showStep(stepNumber) {
            // 隐藏所有步骤
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // 重置所有指示器
            for (let i = 1; i <= 3; i++) {
                const indicator = document.getElementById(`step${i}-indicator`);
                indicator.className = 'w-8 h-8 rounded-full flex items-center justify-center border-2 border-gray-300 font-bold text-gray-500';
                
                if (i < 3) {
                    const line = document.getElementById(`line${i}-${i+1}`);
                    line.className = 'flex-1 h-1 mx-2 bg-gray-300';
                }
            }
            
            // 显示当前步骤
            document.getElementById(`step${stepNumber}`).classList.remove('hidden');
            
            // 更新指示器状态
            for (let i = 1; i <= stepNumber; i++) {
                const indicator = document.getElementById(`step${i}-indicator`);
                if (i === stepNumber) {
                    indicator.className = 'w-8 h-8 rounded-full flex items-center justify-center border-2 border-primary font-bold step-indicator-active';
                } else {
                    indicator.className = 'w-8 h-8 rounded-full flex items-center justify-center border-2 border-green-500 font-bold step-indicator-completed';
                    indicator.innerHTML = '<i class="fa fa-check"></i>';
                }
                
                if (i < stepNumber && i < 3) {
                    const line = document.getElementById(`line${i}-${i+1}`);
                    line.className = 'flex-1 h-1 mx-2 step-line-active';
                }
            }
        }

        // 隐私协议复选框事件 - 增强版
        const acceptPrivacyCheckbox = document.getElementById('accept-privacy');
        const toStep3Button = document.getElementById('to-step3');
        
        // 确保元素存在
        if (acceptPrivacyCheckbox && toStep3Button) {
            // 添加多重事件监听器
            acceptPrivacyCheckbox.addEventListener('change', function() {
                console.log('复选框状态改变:', this.checked);
                toStep3Button.disabled = !this.checked;
                
                // 确保视觉反馈
                if (this.checked) {
                    toStep3Button.classList.remove('opacity-50', 'cursor-not-allowed');
                    toStep3Button.classList.add('opacity-100', 'cursor-pointer');
                } else {
                    toStep3Button.classList.add('opacity-50', 'cursor-not-allowed');
                    toStep3Button.classList.remove('opacity-100', 'cursor-pointer');
                }
            });
            
            // 添加点击事件作为备用
            acceptPrivacyCheckbox.addEventListener('click', function(e) {
                // 手动切换选中状态（作为备用机制）
                setTimeout(() => {
                    console.log('复选框点击后状态:', this.checked);
                    toStep3Button.disabled = !this.checked;
                    
                    if (this.checked) {
                        toStep3Button.classList.remove('opacity-50', 'cursor-not-allowed');
                        toStep3Button.classList.add('opacity-100', 'cursor-pointer');
                    } else {
                        toStep3Button.classList.add('opacity-50', 'cursor-not-allowed');
                        toStep3Button.classList.remove('opacity-100', 'cursor-pointer');
                    }
                }, 0);
            });
            
            // 直接修改按钮样式，确保可点击时更明显
            toStep3Button.style.transition = 'all 0.3s ease';
            toStep3Button.style.pointerEvents = 'auto';
        }

        // 表单提交事件
        document.getElementById('student-info-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 获取必填字段
            const studentName = document.getElementById('student-name').value.trim();
            const educationLevel = document.getElementById('education-level').value;
            
            // 验证必填字段
            if (!studentName) {
                alert('请输入姓名');
                document.getElementById('student-name').focus();
                return;
            }
            
            if (!educationLevel) {
                alert('请选择教育阶段');
                document.getElementById('education-level').focus();
                return;
            }
            
            // 所有验证通过后才保存数据和跳转
            saveFormData();
            
            // 获取"不再显示此协议"选项的状态
            const skipOnboarding = document.getElementById('skip-onboarding')?.checked || false;
            
            // 设置已完成引导的标志
            localStorage.setItem('hasVisited', 'true');
            localStorage.setItem('privacyAccepted', 'true');
            localStorage.setItem('onboardingCompleted', 'true');
            
            // 根据用户选择设置是否永久跳过协议
            localStorage.setItem('permanentlySkipOnboarding', skipOnboarding ? 'true' : 'false');
            
            // 跳转到主页面
            window.location.href = 'index.html';
        });

        // 步骤切换按钮事件
        document.getElementById('to-step2').addEventListener('click', function() {
            showStep(2);
        });

        document.getElementById('back-to-step1').addEventListener('click', function() {
            showStep(1);
        });

        // 增强的下一步按钮点击事件
        if (toStep3Button && acceptPrivacyCheckbox) {
            toStep3Button.addEventListener('click', function(e) {
                e.stopPropagation();
                console.log('下一步按钮点击，复选框状态:', acceptPrivacyCheckbox.checked);
                
                // 即使按钮显示为disabled，也要进行检查并执行
                if (acceptPrivacyCheckbox.checked) {
                    console.log('切换到步骤3');
                    showStep(3);
                } else {
                    console.log('请先同意隐私协议');
                    // 可以添加提示
                    alert('请先阅读并同意隐私协议和服务条款');
                }
            });
            
            // 添加触摸事件支持
            toStep3Button.addEventListener('touchstart', function(e) {
                e.stopPropagation();
                if (acceptPrivacyCheckbox.checked) {
                    showStep(3);
                }
            });
        }

        document.getElementById('back-to-step2').addEventListener('click', function() {
            showStep(2);
        });

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 检查是否已经永久跳过引导
            const hasPermanentlySkipped = localStorage.getItem('permanentlySkipOnboarding') === 'true';
            // 检查是否已经完成引导
            const hasCompletedOnboarding = localStorage.getItem('onboardingCompleted') === 'true';
            
            // 如果已经永久跳过或者已经完成引导，直接跳转到主页面
            // 这样可以避免循环跳转问题，确保用户能够顺利进入系统
            if (hasPermanentlySkipped || hasCompletedOnboarding) {
                window.location.href = 'index.html';
            } else {
                // 恢复可能存在的表单数据
                restoreFormData();
                
                // 显示第一步
                showStep(1);
            }
        });
    </script>
</body>
</html>